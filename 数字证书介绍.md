# 数字证书

## 一、 什么是数字证书

数字安全证书就是网络上识别用户身份信息的一系列数据，数字安全证书就是参与网上交易活动的各方（如持卡人、商家、支付网关）身份的代表，每次交易时，都要通过数字安全证书对各方的身份进行验证。基于数字证书的关键性，数字证书必须有一个大家都**信赖的公正的第三方认证机构**即**CA中心**来颁发和管理。

数字安全证书是一个经证书授权中心数字签名的包含公开密钥拥有者信息以及公开密钥的文件。最简单的证书包含一个公开密钥、名称以及证书授权中心的数字签名。一般情况下证书中还包括密钥的有效时间，发证机关(证书授权中心)的名称，该证书的序列号等信息，证书的格式遵循itut x.509国际标准。

一个**标准的x.509数字安全证书**包含以下一些内容：

证书的版本信息；

证书的序列号，每个证书都有一个唯一的证书序列号；

证书所使用的签名算法；

证书的发行机构名称，命名规则一般采用x.500格式；

证书的有效期，现在通用的证书一般采用utc时间格式；

证书所有人的名称，命名规则一般采用x.500格式；

证书所有人的公开密钥；

证书发行者对证书的签名。

## 二、数字证书的应用场景

随着Internet的普及、各种电子商务活动和电子政务活动的飞速发展，数字证书开始广泛地应用到各个领域之中，目前主要包括：发送安全电子邮件、访问安全站点、网上招标投标、网上签约、网上订购、安全网上公文传送、网上缴费、网上缴税、网上炒股、网上购物和网上报关等。

## 三、CA中心

CA中心的核心职能是发放和管理用户的数字安全证书。CA中心在整个电子商务环境中处于至关重要的位置，它是整个信任链的起点。CA中心是开展电子商务的基础，如果CA中心不安全或发放的证书不具权威性，那么网上电子交易就根本无从谈起。

CA中心所发放的数字安全证书就是网络通讯中标志通讯各方身份信息的一系列数据，提供了一种在Internet上验证用户身份的方式。

## 四、电子签名

电子签名指的是数据电文中以电子形式所含、所附用于识别签名人身份并表明签名人认可其中内容的数据。通俗点说，电子签名就是通过密码技术对电子文档的电子形式的签名。

电子签名是伴随着信息网络技术的发展而出现的一种安全保障技术，目的就是确认交易当事人的真实身份，保证交易的安全性、真实性和不可抵赖性。



## 五、 证书的类型

### 5.1 按颁发的机构

| 证书类型 |        适用网站类型        |                  认证强度                  |
| :------: | :------------------------: | :----------------------------------------: |
| DV域名型 |          个人网站          | CA机构审核个人网站真实性、不验证企业真实性 |
| OV企业型 | 政府组织、企业、教育机构等 |         CA机构审核组织及企业真实性         |

### 

## 5.2 按签发的类型

| 签发类型 | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 自签名   | 1、Root证书自己签发，一般预置在系统中 ； 2、非受信任的用户自己签发的证书 |
| 非自签名 | 由CA中心等受信任的结构签发的证书                             |

非受信任的用户自己签发的证书的风险：

1、秘钥不受浏览器信任
2、安装容易吊销难
3、易被钓鱼
4、有效期过程导致易被破解

## 六、PKI认证体系

### 6.1 PKI相关概念

PKI（Public Key Infrastructure 即公钥基础设施）是一种遵循既定标准的，采用密码技术为网上安全通信提供一整套安全服务的基础平台，能够为所有网络应用提供信息加密和数字签名等密码服务及所必须的密钥与证书管理体系。也就是能够对公私钥对进行管理，支持身份验证、机密性、完整性以及不可否认性服务的具有普适性的信息安全基础设施。

PKI技术是信息安全技术的核心，也是电子商务、电子政务的关键和基础技术。

PKI涉及多个实体之间的协作过程，如CA、RA、KMC。

**证书认证机构（Certificate Authority-CA）**

证书认证机构又称为认证中心或CA中心，它是被用户所信任的签发公钥证书及证书注销列表的管理机构。它是可信任的，并具有权威性、公正性。

**证书注册机构（Registration Authority-RA）**

证书注册机构是证书认证体系中的一个组成部分，它是接收用户证书及证书注销列表申请信息、审核用户真实身份，为用户颁发证书的管理机构。

**密钥管理中心（Key Management Center-KMC）**

密钥管理中心是PKI中的密钥管理机构，主要负责密钥的生成、分发、保存、备份、恢复、更新、归档等管理。

**数字证书（Digital Certificate）**

数字证书是由认证机构（认证权威）数字签名的包含公开密钥拥有者信息、公开密钥、签发者信息、有效期以及一些扩展信息的数字文件。数字证书将PKI中的公钥信息与用户身份信息进行了绑定，由证书可以确定用户的身份。

根据X.509V3标准，数字证书中包含如下信息：

证书版本信息，即为V3；

证书的序列号，每个证书都有唯一的证书序列号；

证书主体名称；

证书所使用的签名算法标识；

证书发行机构的名称；

证书的有效期；

证书所有人的公开密钥；

扩展信息；

证书发行者对证书的签名。

**证书撤销列表（Certificate Revoke List-CRL）**

证书撤销列表是指由认证机构（证书发布者）确定为证书不再有效，并对无效证书进行了签名的证书列表。

依据X.509V2 CRL标准，CRL应包含以下信息：

CRL的版本号；

签名算法：包含算法标识和算法参数，用于指定证书签发机构对CRL内容进行签名的算法；

证书签发机构名称；

此次签发时间；

下次签发时间；

用户公钥信息：包括撤消的证书序列号和证书撤销时间，以及用户公钥；

签名算法：对CRL内容进行签名的签名算法标识；

CRL扩展域；

签名值。

**认证机构证书（Authority Certificate）**

认证机构证书是指签发给认证机构的证书。

**证书验证（Certificate Validation）**

证书验证是指确定证书在指定的时间内是否有效的过程。证书验证包括有效期验证、签名验证以及证书状态的检验。

### 6.2 PKI认证体系

![1660396049297](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1660396049297.png)

上图是**PKI体系的认证过程**，我们拿百度证书认证体系举例：

1、客户端收到com的证书后，发现这个证书的签发者不是根证书，就无法根据本地已有的根证书中的公钥去验证baidu.com证书是否可信。于是，客户端根据baidu.com证书中的签发者，找到该证书的颁发机构是 “GlobalSign Organization Validation CA – SHA256 – G2”，然后向 CA 请求该中间证书。



2、请求到证书后发现 “GlobalSign Organization Validation CA – SHA256 – G2” 证书是由 “GlobalSign Root CA” 签发的，由于 “GlobalSign Root CA” 没有再上级签发机构，说明它是根证书，也就是自签证书。

应用软件会检查此证书有否已预载于根证书清单上，如果有，则可以利用根证书中的公钥去验证 “GlobalSign Organization Validation CA – SHA256 – G2” 证书，如果发现验证通过，就认为该中间证书是可信的。



3、“GlobalSign Organization Validation CA – SHA256 – G2” 证书被信任后，可以使用 “GlobalSign Organization Validation CA – SHA256 – G2” 证书中的公钥去验证com证书的可信性，如果验证通过，就可以信任baidu.com证书。